---
title: "KPPA CART"
author: "Fabian Bong"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Abstract

Kurtosis Projection Pursuit with Classification and Regression Trees (KPPA Cart) encompasses a framework for the robus, unsupervised classification of integrated Multi-Omics data using kurtosis as the function of interest to be minimized. This introductory vignette provides an overview of the steps of the workflow, installation, and source of the dataset used as example.

## Contents

Introduction to KPPACart

More Info & Citation

Example

## Introduction to KPPACart

## More Info & Citation

## Example

A sample data set can be loaded by using `data("KPPACart.Data")`. It contains a list with X, Age and Sex. X represents an RNA count matrix, Age and Sex contain numerically coded age/sex groups. Since Age and Sex contain two groups each, the samples can be split into four total groups. To run KPPACart simply run the function with the default parameters or determine the parameters yourself. The power of KPPACart is that it shows better separation than application of PCA.

```{r}
# Load library
library("KPPACart")

# Load data
data("KPPACart.Data")

# Apply PCA
pca <- prcomp(t(KPPACart.Data$X))

# plot pca colored by age and sex
plot(pca$x[,1], pca$x[,2], col=factor(paste(KPPACart.Data$Sex,KPPACart.Data$Age)),
     xlab="PC1", ylab="PC2")

# Apply KPPACart
n_features <- 100
n_iterations <- 5000
k_dim <- 10
exp_clusters <- 4
n_cores <- 8
res <- KPPACart::KPPACart(KPPACart.Data$X,
                          n_features = n_features,
                          n_iterations = n_iterations,
                          k_dim = k_dim,
                          exp_clusters = exp_clusters,
                          n_cores = n_cores)

# Plot KPPACart result
plot(res$T[,1], res$T[,2], col=factor(paste(KPPACart.Data$Sex,KPPACart.Data$Age)),
     xlab="Component 1", ylab="Component 2")
```
